<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1800" height="1300" viewBox="0 0 1800 1300">
  <defs>
    <style>
      .class-box { fill: #f8f9fa; stroke: #333; stroke-width: 2; }
      .title { font-family: Arial, sans-serif; font-size: 14px; font-weight: bold; text-anchor: middle; }
      .method { font-family: Arial, sans-serif; font-size: 11px; }
      .attribute { font-family: Arial, sans-serif; font-size: 11px; }
      .line { stroke: #333; stroke-width: 1.5; fill: none; }
      .composition { stroke: #333; stroke-width: 2; fill: none; marker-end: url(#diamond); }
      .association { stroke: #333; stroke-width: 1.5; fill: none; marker-end: url(#arrow); }
    </style>
    <marker id="diamond" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <polygon points="0,3 3,0 9,3 3,6" fill="#333"/>
    </marker>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <polygon points="0,0 0,6 9,3" fill="none" stroke="#333"/>
    </marker>
  </defs>

  <text x="900" y="30" class="title" font-size="18">数据结构可视化模拟器 - UML类图（最新结构）</text>

  <text x="900" y="70" class="title" font-size="16">模型层 (Models)</text>

  <g id="linear-structures">
    <text x="220" y="100" class="title" font-size="14">线性结构</text>
    <rect x="50" y="120" width="160" height="120" class="class-box"/>
    <text x="130" y="140" class="title">ArrayList</text>
    <line x1="50" y1="145" x2="210" y2="145" class="line"/>
    <text x="55" y="160" class="attribute">- data: list</text>
    <text x="55" y="175" class="attribute">- capacity: int</text>
    <line x1="50" y1="180" x2="210" y2="180" class="line"/>
    <text x="55" y="195" class="method">+ insert(index, value)</text>
    <text x="55" y="210" class="method">+ remove(index)</text>

    <rect x="230" y="120" width="160" height="140" class="class-box"/>
    <text x="310" y="140" class="title">LinkedList</text>
    <line x1="230" y1="145" x2="390" y2="145" class="line"/>
    <text x="235" y="160" class="attribute">- head: Node</text>
    <text x="235" y="175" class="attribute">- size: int</text>
    <line x1="230" y1="180" x2="390" y2="180" class="line"/>
    <text x="235" y="195" class="method">+ append(value)</text>
    <text x="235" y="210" class="method">+ remove(value)</text>
    <text x="235" y="225" class="method">+ find(value)</text>

    <rect x="255" y="280" width="120" height="80" class="class-box"/>
    <text x="315" y="300" class="title">Node</text>
    <line x1="255" y1="305" x2="375" y2="305" class="line"/>
    <text x="260" y="320" class="attribute">+ data: any</text>
    <text x="260" y="335" class="attribute">+ next: Node</text>

    <rect x="410" y="120" width="160" height="120" class="class-box"/>
    <text x="490" y="140" class="title">Stack</text>
    <line x1="410" y1="145" x2="570" y2="145" class="line"/>
    <text x="415" y="160" class="attribute">- data: list</text>
    <text x="415" y="175" class="attribute">- capacity: int</text>
    <line x1="410" y1="180" x2="570" y2="180" class="line"/>
    <text x="415" y="195" class="method">+ push(value)</text>
    <text x="415" y="210" class="method">+ pop()</text>
  </g>

  <g id="tree-structures">
    <text x="980" y="100" class="title" font-size="14">树形结构</text>

    <rect x="820" y="120" width="140" height="110" class="class-box"/>
    <text x="890" y="140" class="title">TreeNode</text>
    <line x1="820" y1="145" x2="960" y2="145" class="line"/>
    <text x="825" y="160" class="attribute">+ data: any</text>
    <text x="825" y="175" class="attribute">+ left/right</text>

    <rect x="1260" y="120" width="160" height="140" class="class-box"/>
    <text x="1340" y="140" class="title">BinaryTree</text>
    <line x1="1260" y1="145" x2="1420" y2="145" class="line"/>
    <text x="1265" y="160" class="attribute">- root: TreeNode</text>
    <line x1="1260" y1="165" x2="1420" y2="165" class="line"/>
    <text x="1265" y="180" class="method">+ insert(value)</text>
    <text x="1265" y="195" class="method">+ delete(value)</text>
    <text x="1265" y="210" class="method">+ search(value)</text>

    <rect x="760" y="280" width="160" height="120" class="class-box"/>
    <text x="840" y="300" class="title">BST</text>
    <line x1="760" y1="305" x2="920" y2="305" class="line"/>
    <text x="765" y="320" class="method">+ insert(value)</text>
    <text x="765" y="335" class="method">+ delete(value)</text>
    <text x="765" y="350" class="method">+ search(value)</text>

    <rect x="940" y="280" width="160" height="140" class="class-box"/>
    <text x="1020" y="300" class="title">AVLTree</text>
    <line x1="940" y1="305" x2="1100" y2="305" class="line"/>
    <text x="945" y="320" class="method">+ insert(value)</text>
    <text x="945" y="335" class="method">+ delete(value)</text>
    <text x="945" y="350" class="method">+ rotate_left/right()</text>

    <rect x="1120" y="280" width="160" height="120" class="class-box"/>
    <text x="1200" y="300" class="title">HuffmanTree</text>
    <line x1="1120" y1="305" x2="1280" y2="305" class="line"/>
    <text x="1125" y="320" class="attribute">- frequency_map: dict</text>
    <line x1="1120" y1="325" x2="1280" y2="325" class="line"/>
    <text x="1125" y="340" class="method">+ build_with_steps(map)</text>
    <text x="1125" y="355" class="method">+ encode/decode()</text>

    <rect x="1080" y="120" width="140" height="100" class="class-box"/>
    <text x="1150" y="140" class="title">HuffmanNode</text>
    <line x1="1080" y1="145" x2="1220" y2="145" class="line"/>
    <text x="1085" y="160" class="attribute">+ char/freq</text>

    <rect x="980" y="120" width="140" height="100" class="class-box"/>
    <text x="1050" y="140" class="title">AVLNode</text>
    <line x1="980" y1="145" x2="1120" y2="145" class="line"/>
    <text x="985" y="160" class="attribute">+ value/height</text>
  </g>

  <text x="700" y="640" class="title" font-size="16">控制器层 (Controllers)</text>

  <rect x="380" y="660" width="220" height="160" class="class-box"/>
  <text x="490" y="680" class="title">AppController</text>
  <line x1="380" y1="685" x2="600" y2="685" class="line"/>
  <text x="385" y="700" class="attribute">- main_window: MainWindow</text>
  <text x="385" y="715" class="attribute">- linear_controller: LinearController</text>
  <text x="385" y="730" class="attribute">- tree_controller: TreeController</text>
  <text x="385" y="745" class="attribute">- dsl_controller: DSLController</text>
  <text x="385" y="760" class="attribute">- nl_controller: NLController</text>
  <line x1="380" y1="765" x2="600" y2="765" class="line"/>
  <text x="385" y="780" class="method">+ show_main_window()</text>
  <text x="385" y="795" class="method">+ save_structure()/load_structure()</text>

  <rect x="40" y="660" width="200" height="130" class="class-box"/>
  <text x="140" y="680" class="title">LinearController</text>
  <line x1="40" y1="685" x2="240" y2="685" class="line"/>
  <text x="45" y="700" class="attribute">- view: LinearView</text>
  <text x="45" y="715" class="attribute">- current_structure</text>
  <line x1="40" y1="720" x2="240" y2="720" class="line"/>
  <text x="45" y="735" class="method">+ handle_action(type, params)</text>

  <rect x="640" y="660" width="200" height="130" class="class-box"/>
  <text x="740" y="680" class="title">TreeController</text>
  <line x1="640" y1="685" x2="840" y2="685" class="line"/>
  <text x="645" y="700" class="attribute">- view: TreeView</text>
  <text x="645" y="715" class="attribute">- current_tree</text>
  <line x1="640" y1="720" x2="840" y2="720" class="line"/>
  <text x="645" y="735" class="method">+ handle_action(type, params)</text>

  <rect x="900" y="540" width="200" height="140" class="class-box"/>
  <text x="1000" y="560" class="title">DSLController</text>
  <line x1="900" y1="565" x2="1100" y2="565" class="line"/>
  <text x="905" y="580" class="attribute">- linear_controller</text>
  <text x="905" y="595" class="attribute">- tree_controller</text>
  <line x1="900" y1="600" x2="1100" y2="600" class="line"/>
  <text x="905" y="615" class="method">+ set_context_target()</text>
  <text x="905" y="630" class="method">+ process_command()/script()</text>

  <rect x="1120" y="540" width="200" height="120" class="class-box"/>
  <text x="1220" y="560" class="title">NLController</text>
  <line x1="1120" y1="565" x2="1320" y2="565" class="line"/>
  <text x="1125" y="580" class="attribute">- dsl_controller: DSLController</text>
  <line x1="1120" y1="585" x2="1320" y2="585" class="line"/>
  <text x="1125" y="600" class="method">+ handle_nl_command(text, ctx)</text>

  <text x="420" y="1040" class="title" font-size="16">视图层 (Views)</text>

  <rect x="300" y="860" width="220" height="160" class="class-box"/>
  <text x="410" y="880" class="title">MainWindow</text>
  <line x1="300" y1="885" x2="520" y2="885" class="line"/>
  <text x="305" y="900" class="attribute">- linear_view: LinearView</text>
  <text x="305" y="915" class="attribute">- tree_view: TreeView</text>
  <text x="305" y="930" class="attribute">- tab_widget: QTabWidget</text>
  <line x1="300" y1="935" x2="520" y2="935" class="line"/>
  <text x="305" y="950" class="method">+ showMaximized()</text>

  <rect x="50" y="860" width="200" height="140" class="class-box"/>
  <text x="150" y="880" class="title">LinearView</text>
  <line x1="50" y1="885" x2="250" y2="885" class="line"/>
  <text x="55" y="900" class="attribute">- canvas: LinearCanvas</text>
  <line x1="50" y1="905" x2="250" y2="905" class="line"/>
  <text x="55" y="920" class="method">+ update_visualization(data)</text>

  <rect x="580" y="860" width="200" height="160" class="class-box"/>
  <text x="680" y="880" class="title">TreeView</text>
  <line x1="580" y1="885" x2="780" y2="885" class="line"/>
  <text x="585" y="900" class="attribute">- canvas: TreeCanvas</text>
  <line x1="580" y1="905" x2="780" y2="905" class="line"/>
  <text x="585" y="920" class="method">+ show_bst_build_animation()</text>
  <text x="585" y="935" class="method">+ show_bst_delete_animation()</text>

  <rect x="50" y="1040" width="200" height="120" class="class-box"/>
  <text x="150" y="1060" class="title">LinearCanvas</text>
  <line x1="50" y1="1065" x2="250" y2="1065" class="line"/>
  <text x="55" y="1080" class="method">+ update_data(data)</text>

  <rect x="580" y="1040" width="200" height="120" class="class-box"/>
  <text x="680" y="1060" class="title">TreeCanvas</text>
  <line x1="580" y1="1065" x2="780" y2="1065" class="line"/>
  <text x="585" y="1080" class="method">+ update_data(data)</text>

  <text x="1100" y="860" class="title" font-size="16">服务/工具 (Services/Utils)</text>

  <rect x="980" y="880" width="200" height="120" class="class-box"/>
  <text x="1080" y="900" class="title">OperationRecorder</text>
  <line x1="980" y1="905" x2="1180" y2="905" class="line"/>
  <text x="985" y="920" class="method">+ record_dsl(text, ctx, ok, src)</text>

  <rect x="1200" y="880" width="200" height="120" class="class-box"/>
  <text x="1300" y="900" class="title">LLMAgent</text>
  <line x1="1200" y1="905" x2="1400" y2="905" class="line"/>
  <text x="1205" y="920" class="method">+ infer_dsl(text)</text>

  <rect x="1420" y="880" width="200" height="140" class="class-box"/>
  <text x="1520" y="900" class="title">DSLParser</text>
  <line x1="1420" y1="905" x2="1620" y2="905" class="line"/>
  <text x="1425" y="920" class="method">+ parse_dsl_command(text)</text>

  <g id="relations">
    <path d="M 150 1000 Q 150 1020 150 1040" class="composition"/>
    <path d="M 680 1020 Q 680 1030 680 1040" class="composition"/>
    <path d="M 410 940 Q 300 900 150 860" class="composition"/>
    <path d="M 410 940 Q 520 900 680 860" class="composition"/>

    <path d="M 380 720 Q 320 710 240 720" class="association"/>
    <path d="M 600 720 Q 620 710 640 720" class="association"/>
    <path d="M 600 700 Q 800 680 1000 540" class="association"/>
    <path d="M 600 740 Q 850 730 1220 540" class="association"/>

    <path d="M 1000 680 Q 1040 750 1080 880" class="association"/>
    <path d="M 1000 680 Q 1280 760 1520 880" class="association"/>
    <path d="M 1220 600 Q 1100 580 1000 540" class="association"/>

    <path d="M 740 660 Q 780 540 840 280" class="association"/>
    <path d="M 740 660 Q 1040 500 1340 120" class="association"/>
    <path d="M 740 660 Q 840 560 1020 280" class="association"/>
    <path d="M 740 660 Q 920 540 1200 280" class="association"/>
    <path d="M 140 660 Q 110 420 130 120" class="association"/>
    <path d="M 140 660 Q 200 420 310 120" class="association"/>
    <path d="M 140 660 Q 320 420 490 120" class="association"/>

    <path d="M 840 280 Q 850 250 890 230" class="composition"/>
    <path d="M 1340 260 Q 1160 220 890 230" class="composition"/>
    <path d="M 1020 280 Q 1030 240 1050 220" class="composition"/>
    <path d="M 1200 280 Q 1180 240 1150 220" class="composition"/>
    <path d="M 310 260 Q 320 270 315 280" class="composition"/>
  </g>

  <text x="70" y="1220" class="title" font-size="14">图例</text>
  <line x1="60" y1="1240" x2="110" y2="1240" class="composition"/>
  <text x="120" y="1245" class="method">组合</text>
  <line x1="200" y1="1240" x2="250" y2="1240" class="association"/>
  <text x="260" y="1245" class="method">关联</text>
</svg>